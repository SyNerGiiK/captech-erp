{% extends "portal/base.html" %}
{% block title %}Admin Dashboard - CapTech ERP{% endblock %}
{% block page_title %}Admin Dashboard{% endblock %}
{% block content %}
<div class="grid grid-cols-1 md:grid-cols-5 gap-4 mb-6">
  <div class="card p-4">
    <div class="text-xs text-slate-500">TOTAL</div>
    <div class="text-2xl font-semibold">{{ stats.total }}</div>
  </div>
  <div class="card p-4">
    <div class="text-xs text-slate-500">OUVERTS</div>
    <div class="text-2xl font-semibold">{{ stats.open }}</div>
  </div>
  <div class="card p-4">
    <div class="text-xs text-slate-500">EN COURS</div>
    <div class="text-2xl font-semibold">{{ stats.in_progress }}</div>
  </div>
  <div class="card p-4">
    <div class="text-xs text-slate-500">EN ATTENTE</div>
    <div class="text-2xl font-semibold">{{ stats.waiting }}</div>
  </div>
  <div class="card p-4">
    <div class="text-xs text-slate-500">FERMÉS</div>
    <div class="text-2xl font-semibold">{{ stats.closed }}</div>
  </div>
</div>

<div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
  <section class="lg:col-span-2 card">
    <div class="px-4 py-3 border-b border-slate-200 font-medium">Derniers événements</div>
    <div class="p-4">
      {% if events %}
      <ul class="divide-y divide-slate-200 text-sm">
        {% for e in events %}
          <li class="py-2">
            <div class="text-slate-700">{{ e.created_at }} — <span class="font-medium">{{ e.kind }}</span></div>
            <div class="text-slate-500">
              {% if e.ticket_id %}
                <a class="underline hover:text-slate-700" href="{% url 'portal:ticket_detail' e.ticket_id %}">Ticket #{{ e.ticket_id }}</a> —
              {% endif %}
              {{ e.message }}
            </div>
          </li>
        {% endfor %}
      </ul>
      {% else %}<div class="text-slate-500 text-sm">Aucun événement.</div>{% endif %}
    </div>
  </section>

  <section class="card">
    <div class="px-4 py-3 border-b border-slate-200 font-medium">Service Checks (dernier état)</div>
    <div class="p-4 text-sm text-slate-500">Aucun check</div>
  </section>
</div>
{% endblock %}
